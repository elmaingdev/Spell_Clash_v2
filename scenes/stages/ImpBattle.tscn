[gd_scene load_steps=19 format=4 uid="uid://c7gx5wntkyw0t"]

[ext_resource type="Script" uid="uid://dimk00kx0fxk5" path="res://scripts/Battle.gd" id="1_i0o0p"]
[ext_resource type="Script" uid="uid://bcghxxakdsd3q" path="res://scripts/system/ModeSwitcher.gd" id="2_07m10"]
[ext_resource type="PackedScene" uid="uid://bmg5ivlx0bfvn" path="res://scenes/UI/TurnTimer.tscn" id="3_pdqvv"]
[ext_resource type="PackedScene" uid="uid://cqtct4bo5es3n" path="res://scenes/UI/TypingPanel.tscn" id="4_8dj0a"]
[ext_resource type="PackedScene" uid="uid://0ij85ox8j5li" path="res://scenes/UI/DirectionsPanel.tscn" id="5_pxlq0"]
[ext_resource type="PackedScene" uid="uid://c566mi0ppmg2g" path="res://scenes/UI/InfoPanel.tscn" id="6_7wnu1"]
[ext_resource type="PackedScene" uid="uid://ts0saqd7n1w" path="res://scenes/UI/ScorePanel.tscn" id="7_2hqq3"]
[ext_resource type="PackedScene" uid="uid://bwyo15q3n6htl" path="res://scenes/UI/BottomPanel.tscn" id="8_2af8h"]
[ext_resource type="PackedScene" uid="uid://bwjuv6o6yi6rb" path="res://scenes/UI/ComboPanel.tscn" id="9_ecd3a"]
[ext_resource type="PackedScene" uid="uid://cgv2y31m0qgut" path="res://scenes/UI/SpeedPanel.tscn" id="10_dnvb4"]
[ext_resource type="PackedScene" uid="uid://c6xw45ilhwral" path="res://scenes/chars/mage_1.tscn" id="11_d8p3n"]
[ext_resource type="Texture2D" uid="uid://btv78miml7aol" path="res://assets/backgrounds/minion_bg_def.png" id="13_5xx6m"]
[ext_resource type="TileSet" uid="uid://hf1l66v0orbv" path="res://themes/TileMap.tres" id="14_hchx2"]
[ext_resource type="AudioStream" uid="uid://dtderyonblk36" path="res://assets/bgm/march_of_iron.wav" id="15_unpja"]
[ext_resource type="Script" uid="uid://cy4qmcgfo0a4c" path="res://scripts/system/ProjectilePool.gd" id="16_3wef5"]
[ext_resource type="PackedScene" uid="uid://baj4vmtxbrupq" path="res://scenes/chars/projectile_1.tscn" id="17_mpxy1"]
[ext_resource type="PackedScene" uid="uid://cxwta47m0lft8" path="res://scenes/chars/projectile_2.tscn" id="18_1mf7l"]
[ext_resource type="PackedScene" uid="uid://dihlnjtxvan23" path="res://scenes/chars/Imp.tscn" id="18_5xx6m"]

[node name="Battle" type="Node2D"]
script = ExtResource("1_i0o0p")
typing_panel_path = NodePath("CanvasLayer/UI/TypingPanel")
directions_panel_path = NodePath("CanvasLayer/UI/DirectionsPanel")
timer_path = NodePath("CanvasLayer/UI/TurnTimer")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="UI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ModeSwitcher" type="Node" parent="CanvasLayer/UI"]
unique_name_in_owner = true
script = ExtResource("2_07m10")
typing_path = NodePath("../TypingPanel")
defend_path = NodePath("../DirectionsPanel")
bottom_path = NodePath("../BottomPanel")
timer_path = NodePath("../TurnTimer")

[node name="TurnTimer" parent="CanvasLayer/UI" instance=ExtResource("3_pdqvv")]
unique_name_in_owner = true
layout_mode = 1

[node name="TypingPanel" parent="CanvasLayer/UI" node_paths=PackedStringArray("timer_ref") instance=ExtResource("4_8dj0a")]
unique_name_in_owner = true
layout_mode = 1
timer_ref = NodePath("../TurnTimer")

[node name="DirectionsPanel" parent="CanvasLayer/UI" node_paths=PackedStringArray("timer_ref") instance=ExtResource("5_pxlq0")]
unique_name_in_owner = true
visible = false
layout_mode = 1
timer_ref = NodePath("../TurnTimer")
player_path = NodePath("../../../Mage_1")

[node name="InfoPanel" parent="CanvasLayer/UI" instance=ExtResource("6_7wnu1")]
unique_name_in_owner = true
layout_mode = 1

[node name="ScorePanel" parent="CanvasLayer/UI" instance=ExtResource("7_2hqq3")]
layout_mode = 1
typing_panel_path = NodePath("../TypingPanel")

[node name="BottomPanel" parent="CanvasLayer/UI" instance=ExtResource("8_2af8h")]
unique_name_in_owner = true
z_index = 500
z_as_relative = false
layout_mode = 1

[node name="ComboPanel" parent="CanvasLayer/UI" instance=ExtResource("9_ecd3a")]
layout_mode = 1

[node name="SpeedPanel" parent="CanvasLayer/UI" instance=ExtResource("10_dnvb4")]
layout_mode = 1

[node name="Mage_1" parent="." node_paths=PackedStringArray("projectile_pool") instance=ExtResource("11_d8p3n")]
unique_name_in_owner = true
position = Vector2(169.00002, 275)
typing_panel_path = NodePath("../CanvasLayer/UI/TypingPanel")
projectile_pool = NodePath("../PlayerProjectilePool")

[node name="Enemy" parent="." node_paths=PackedStringArray("projectile_pool") instance=ExtResource("18_5xx6m")]
unique_name_in_owner = true
position = Vector2(475, 271)
projectile_pool = NodePath("../EnemyProjectilePool")

[node name="Stage" type="Node2D" parent="."]

[node name="ParallaxBackground" type="ParallaxBackground" parent="Stage"]

[node name="BG" type="Sprite2D" parent="Stage/ParallaxBackground"]
position = Vector2(320, 153)
scale = Vector2(1, 1.002)
texture = ExtResource("13_5xx6m")

[node name="TileMapLayer" type="TileMapLayer" parent="Stage"]
tile_map_data = PackedByteArray("AAAIABEAAAABABIAAAAIABIAAAABABMAAAAIABMAAAABABQAAAAJABEAAAACABIAAAAJABIAAAACABMAAAAJABMAAAACABQAAAAKABEAAAADABIAAAAKABIAAAADABMAAAAKABMAAAADABQAAAALABEAAAAEABIAAAALABIAAAAEABMAAAALABMAAAAEABQAAAAMABEAAAAFABIAAAAMABIAAAAFABMAAAAMABMAAAAFABQAAAADABEAAAAEABIAAAADABIAAAAEABMAAAADABMAAAAEABQAAAAEABEAAAAFABIAAAAEABIAAAAFABMAAAAEABMAAAAFABQAAAAFABEAAAADABIAAAAFABIAAAADABMAAAAFABMAAAADABQAAAAGABEAAAAEABIAAAAGABIAAAAEABMAAAAGABMAAAAEABQAAAAHABEAAAAFABIAAAAHABIAAAAFABMAAAAHABMAAAAFABQAAAAAABEAAAABABIAAAAAABIAAAABABMAAAAAABMAAAABABQAAAABABEAAAACABIAAAABABIAAAACABMAAAABABMAAAACABQAAAACABEAAAADABIAAAACABIAAAADABMAAAACABMAAAADABQAAAANABEAAAABABIAAAANABIAAAABABMAAAANABMAAAABABQAAAAOABEAAAACABIAAAAOABIAAAACABMAAAAOABMAAAACABQAAAAPABEAAAADABIAAAAPABIAAAADABMAAAAPABMAAAADABQAAAAQABEAAAAEABIAAAAQABIAAAAEABMAAAAQABMAAAAEABQAAAARABEAAAAFABIAAAARABIAAAAFABMAAAARABMAAAAFABQAAAASABEAAAABABIAAAASABIAAAABABMAAAASABMAAAABABQAAAATABEAAAACABIAAAATABIAAAACABMAAAATABMAAAACABQAAAAUABEAAAADABIAAAAUABIAAAADABMAAAAUABMAAAADABQAAAAVABEAAAAEABIAAAAVABIAAAAEABMAAAAVABMAAAAEABQAAAAWABEAAAAFABIAAAAWABIAAAAFABMAAAAWABMAAAAFABQAAAAXABEAAAABABIAAAAXABIAAAABABMAAAAXABMAAAABABQAAAAYABEAAAACABIAAAAYABIAAAACABMAAAAYABMAAAACABQAAAAZABEAAAADABIAAAAZABIAAAADABMAAAAZABMAAAADABQAAAAaABEAAAAEABIAAAAaABIAAAAEABMAAAAaABMAAAAEABQAAAAbABEAAAAFABIAAAAbABIAAAAFABMAAAAbABMAAAAFABQAAAAcABEAAAABABIAAAAcABIAAAABABMAAAAcABMAAAABABQAAAAdABEAAAACABIAAAAdABIAAAACABMAAAAdABMAAAACABQAAAAeABEAAAADABIAAAAeABIAAAADABMAAAAeABMAAAADABQAAAAfABEAAAABABIAAAAfABIAAAABABMAAAAfABMAAAABABQAAAAgABEAAAACABIAAAAgABIAAAACABMAAAAgABMAAAACABQAAAAhABEAAAADABIAAAAhABIAAAADABMAAAAhABMAAAADABQAAAAiABEAAAAEABIAAAAiABIAAAAEABMAAAAiABMAAAAEABQAAAAjABEAAAABABIAAAAjABIAAAABABMAAAAjABMAAAABABQAAAAkABEAAAACABIAAAAkABIAAAACABMAAAAkABMAAAACABQAAAAlABEAAAADABIAAAAlABIAAAADABMAAAAlABMAAAADABQAAAAmABEAAAAEABIAAAAmABIAAAAEABMAAAAmABMAAAAEABQAAAAnABEAAAAFABIAAAAnABIAAAAFABMAAAAnABMAAAAFABQAAAAAABQAAAABABQAAAABABQAAAACABQAAAACABQAAAADABQAAAADABQAAAAEABQAAAAEABQAAAAFABQAAAAAABUAAAABABQAAAABABUAAAACABQAAAACABUAAAADABQAAAADABUAAAAEABQAAAAEABUAAAAFABQAAAAAABYAAAABABQAAAABABYAAAACABQAAAACABYAAAADABQAAAADABYAAAAEABQAAAAEABYAAAAFABQAAAAFABYAAAABABQAAAAGABYAAAACABQAAAAHABYAAAADABQAAAAIABYAAAAEABQAAAAJABYAAAAFABQAAAAFABUAAAABABQAAAAGABUAAAACABQAAAAHABUAAAADABQAAAAIABUAAAAEABQAAAAJABUAAAAFABQAAAAFABQAAAABABQAAAAGABQAAAACABQAAAAHABQAAAADABQAAAAIABQAAAAEABQAAAAJABQAAAAFABQAAAAKABQAAAABABQAAAALABQAAAACABQAAAAMABQAAAADABQAAAANABQAAAAEABQAAAAOABQAAAAFABQAAAAKABUAAAABABQAAAALABUAAAACABQAAAAMABUAAAADABQAAAANABUAAAAEABQAAAAOABUAAAAFABQAAAAKABYAAAABABQAAAALABYAAAACABQAAAAMABYAAAADABQAAAANABYAAAAEABQAAAAOABYAAAAFABQAAAAPABYAAAABABQAAAAQABYAAAACABQAAAARABYAAAADABQAAAASABYAAAAEABQAAAATABYAAAAFABQAAAAPABUAAAABABQAAAAQABUAAAACABQAAAARABUAAAADABQAAAASABUAAAAEABQAAAATABUAAAAFABQAAAAPABQAAAABABQAAAAQABQAAAACABQAAAARABQAAAADABQAAAASABQAAAAEABQAAAATABQAAAAFABQAAAAUABQAAAABABQAAAAVABQAAAACABQAAAAWABQAAAADABQAAAAXABQAAAAEABQAAAAYABQAAAAFABQAAAAUABUAAAABABQAAAAVABUAAAACABQAAAAWABUAAAADABQAAAAXABUAAAAEABQAAAAYABUAAAAFABQAAAAUABYAAAABABQAAAAVABYAAAACABQAAAAWABYAAAADABQAAAAXABYAAAAEABQAAAAYABYAAAAFABQAAAAZABYAAAABABQAAAAaABYAAAACABQAAAAbABYAAAADABQAAAAcABYAAAAEABQAAAAdABYAAAAFABQAAAAZABUAAAABABQAAAAaABUAAAACABQAAAAbABUAAAADABQAAAAcABUAAAAEABQAAAAdABUAAAAFABQAAAAZABQAAAABABQAAAAaABQAAAACABQAAAAbABQAAAADABQAAAAcABQAAAAEABQAAAAdABQAAAAFABQAAAAeABQAAAABABQAAAAfABQAAAACABQAAAAgABQAAAADABQAAAAhABQAAAAEABQAAAAiABQAAAAFABQAAAAeABUAAAABABQAAAAfABUAAAACABQAAAAgABUAAAADABQAAAAhABUAAAAEABQAAAAiABUAAAAFABQAAAAeABYAAAABABQAAAAfABYAAAACABQAAAAgABYAAAADABQAAAAhABYAAAAEABQAAAAiABYAAAAFABQAAAAjABUAAAABABQAAAAkABUAAAACABQAAAAlABUAAAADABQAAAAmABUAAAAEABQAAAAnABUAAAAFABQAAAAjABQAAAABABQAAAAkABQAAAACABQAAAAlABQAAAADABQAAAAmABQAAAAEABQAAAAnABQAAAAFABQAAAAjABYAAAABABQAAAAkABYAAAACABQAAAAlABYAAAADABQAAAAmABYAAAAEABQAAAAnABYAAAAFABQAAAA=")
tile_set = ExtResource("14_hchx2")

[node name="BGM" type="AudioStreamPlayer" parent="."]
unique_name_in_owner = true
stream = ExtResource("15_unpja")
volume_db = -6.0
autoplay = true
bus = &"BGM"

[node name="PlayerProjectilePool" type="Node" parent="."]
script = ExtResource("16_3wef5")
projectile_scene = ExtResource("17_mpxy1")
metadata/_custom_type_script = "uid://cy4qmcgfo0a4c"

[node name="EnemyProjectilePool" type="Node" parent="."]
script = ExtResource("16_3wef5")
projectile_scene = ExtResource("18_1mf7l")
metadata/_custom_type_script = "uid://cy4qmcgfo0a4c"

[connection signal="timeout" from="CanvasLayer/UI/TurnTimer" to="CanvasLayer/UI/TypingPanel" method="_on_timer_timeout"]
